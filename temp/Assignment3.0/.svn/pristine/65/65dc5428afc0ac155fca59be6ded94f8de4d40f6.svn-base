from flask import Flask, request, session, g, redirect, url_for, abort, render_template, flash
import xmltodict
import os.path
import json
from xml_helper import xml_obj


APP_ROOT = os.path.dirname(os.path.abspath(__file__))
APP_STATIC = os.path.join(APP_ROOT, 'static')
APP_TEMPLATES = os.path.join(APP_ROOT, 'templates')
xml_file = os.path.join(APP_STATIC, 'svn_list.xml')
xml = xml_obj(xml_file)
app = Flask(__name__)


@app.route('/')
def hello_world():
    return render_template('index.html', projects=xml.get_projects())


@app.route('/dirs/<path:url>')
def directory(url):
    files = xml.get_files(url)
    dirs = xml.get_dirs(url)
    url_split = url.split('/')
    return render_template('show.html', files=files, dirs=dirs, url=url_split)


if __name__ == '__main__':
    app.run(debug=True)
